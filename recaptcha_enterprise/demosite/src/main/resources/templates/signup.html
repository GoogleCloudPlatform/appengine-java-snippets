<!--
  Copyright 2023 Google LLC
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<!DOCTYPE html>
<html lang="en-us" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Sign up: reCAPTCHA Demo</title>
    <!-- ATTENTION: reCAPTCHA Example (Client Part 1 of 2) Starts -->
    <!-- https://cloud.google.com/recaptcha-enterprise/docs/instrument-web-pages#html-button -->
    <script
      th:src="@{https://www.google.com/recaptcha/enterprise.js(render=${site_key})}"
    ></script>
    <script type="text/javascript">
      async function handleToken(token) {
        await doSignup({ token });
      }
    </script>
    <!-- https://cloud.google.com/recaptcha-enterprise/docs/create-assessment -->
    <script type="text/javascript">
      async function doSignup({ email = "", passwords = [], token }) {
        // Include the token for server-side assessment
        // Include the user input values from your form
        // Always use HTTPS to encrypt plain text credentials!
        const body = {
          email,
          passwords,
          token,
        };
        // Fetch from your backend; assessments must be server-side!
        // Refer to the backend demo code for more information
        // If using a library or framework, can fetch your usual way
        const score = await fetchServerResponse({
          body,
          url: "on_signup",
        });
        // DON'T include an assessment your real response
        // This demo uses a score in client-side code only to illustrate
        // It's the most secure to handle things server-side!
        useAssessmentInClient(score);
      }
    </script>
    <!-- ATTENTION: reCAPTCHA Example (Client Part 1 of 2) Ends -->
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta
      name="description"
      content="Explore the different ways of using reCAPTCHA Enterprise to protect web sites and applications."
    />
    <link
      href="https://fonts.googleapis.com/css?family=Press+Start+2P"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Material+Icons&display=block"
      rel="stylesheet"
    />
    <link rel="icon" type="image/x-icon" href="/favicon-e9e3fe3130a875eb.ico" />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/favicon-16x16-e9e3fe3130a875eb.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/favicon-32x32-e9e3fe3130a875eb.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="48x48"
      href="/favicon-48x48-e9e3fe3130a875eb.png"
    />
    <link href="/global-15fca5ccf020c02b.css" rel="stylesheet" />
    <link href="/demo-81d99a00.css" rel="stylesheet" />
    <script src="/demo-39df041b.js" type="module"></script>
    <script async defer src="/global-e680a49614fd8ff8.js" type="text/javascript"></script>
  </head>
  <body>
    <recaptcha-demo step="signup">
      <!-- ATTENTION: reCAPTCHA Example (Client Part 2 of 2) Starts -->
      <button
        class="g-recaptcha"
        data-action="sign_up"
        data-callback="handleToken"
        th:data-sitekey="${site_key}"
        disabled="disabled"
      >
        Sign up
      </button>
      <!-- ATTENTION: reCAPTCHA Example (Client Part 2 of 2) Ends -->
    </recaptcha-demo>
  </body>
</html>
